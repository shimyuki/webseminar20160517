package window.whiteboard.imgdoc {	import flash.display.*;	import flash.events.*;	import flash.text.*;	import flash.ui.*;	import flash.filters.*;	import common.*;		public class SelectPlusPanel extends Sprite {		private const ADD_FILE:String = Main.LANG.getParam( "ファイルアップロード");		private const ADD_DIR:String = Main.LANG.getParam( "新規フォルダ追加");		private const LABEL_OK:String = "OK";		private var m_textDirName:TextField;		private var m_btnOk:DynamicTextBtn;		private var CELL_H:Number = 22;				public function SelectPlusPanel() {						var labAddFile:TextField = TextField( addChild( new TextField()));			labAddFile.defaultTextFormat = new TextFormat( Main.CONF.getMainFont(), 10);			labAddFile.autoSize = TextFieldAutoSize.LEFT;			labAddFile.text = ADD_FILE;			labAddFile.selectable = labAddFile.mouseEnabled = false;			labAddFile.x = 15;			labAddFile.y = ( CELL_H - labAddFile.height) / 2;						var labAddDir:TextField = TextField( addChild( new TextField()));			labAddDir.defaultTextFormat = new TextFormat( Main.CONF.getMainFont(), 10);			labAddDir.autoSize = TextFieldAutoSize.LEFT;			labAddDir.text = ADD_DIR;			labAddDir.selectable = labAddDir.mouseEnabled = false;			labAddDir.x = labAddFile.x;			labAddDir.y = CELL_H + labAddFile.y;						m_textDirName = TextField( addChild( new TextField()));			labAddDir.defaultTextFormat = new TextFormat( Main.CONF.getMainFont(), 12);			m_textDirName.background = true;			m_textDirName.border = true;			m_textDirName.borderColor = 0xaaaaaa;			m_textDirName.type = TextFieldType.INPUT;			m_textDirName.width = labAddDir.width > labAddFile.width ? labAddDir.width : labAddFile.width;			m_textDirName.height = 17;			m_textDirName.x = labAddFile.x;			m_textDirName.y = labAddDir.y + labAddDir.height + 1;			m_textDirName.maxChars = 20;			m_textDirName.restrict = '^\/¥:*?"<>';			m_textDirName.addEventListener( KeyboardEvent.KEY_DOWN,										   function (e:KeyboardEvent) {												if( e.keyCode == Keyboard.ENTER){													if( m_textDirName.text != '') dispatchEvent( new Event( "addDir"));												}										   });						m_btnOk = DynamicTextBtn( addChild( new DynamicTextBtn( LABEL_OK, 10, CELL_H - 4, 2, 2)));			m_btnOk.setEnabled( true);			m_textDirName.width -= ( m_btnOk.width + 3);			m_btnOk.x = m_textDirName.x + m_textDirName.width + 3;			m_btnOk.y = m_textDirName.y;			m_btnOk.addEventListener( MouseEvent.CLICK,						function( e:*) {							if( m_textDirName.text != '') dispatchEvent( new Event( "addDir"));						});						var w:Number = labAddFile.x + labAddFile.width + 5;						var clickArea:Sprite = Sprite( addChild( new Sprite()));			clickArea.graphics.beginFill( 0, 0);			clickArea.graphics.drawRect( 0, 0, w, CELL_H);			clickArea.graphics.endFill();			clickArea.addEventListener( MouseEvent.CLICK,						function( e:*) {							dispatchEvent( new Event( "addFile"));						});						var hover:Sprite = Sprite( addChildAt( new Sprite(), 0));			hover.graphics.beginFill( 0xc9e6f8);			hover.graphics.drawRect( 1, 1, w - 2, CELL_H - 1.5);			hover.graphics.endFill();						var arrow00 = hover.addChild( getArrow());			arrow00.x = 10;			arrow00.y = CELL_H / 2;						hover.visible = false;			clickArea.addEventListener( MouseEvent.ROLL_OVER,						function( e:*) {							hover.visible = true;						});			clickArea.addEventListener( MouseEvent.ROLL_OUT,						function( e:*) {							hover.visible = false;						});						graphics.beginFill( 0xffffff);			graphics.lineStyle( 5, 0xffffff);			graphics.drawRect( 0, 0, w, m_textDirName.y + m_textDirName.height + 5);			graphics.endFill();			graphics.lineStyle( 2, 0xd9d9d9);			graphics.drawRect( 0, 0, w, m_textDirName.y + m_textDirName.height + 5);			graphics.endFill();						graphics.lineStyle( 1, 0xd9d9d9);			graphics.moveTo( 0, CELL_H);			graphics.lineTo( w, CELL_H);			graphics.endFill();						var arrow01 = addChildAt( getArrow(), 0);			arrow01.x = 10;			arrow01.y = CELL_H / 2;						var arrow02 = addChildAt( getArrow(), 0);			arrow02.x = arrow01.x;			arrow02.y = labAddDir.y + labAddDir.height / 2;			arrow02.rotation = 90;						filters = [ getBitmapFilter()];						addEventListener( Event.ADDED_TO_STAGE, function( e:*) { stage.focus = m_textDirName;});					}		function getArrow() : Shape {			var ret:Shape = new Shape();			ret.graphics.beginFill( 0x000000);			ret.graphics.moveTo( -2.5, -2.5);			ret.graphics.lineTo( -2.5, 2.5);			ret.graphics.lineTo( 2.5, 0);			ret.graphics.endFill();			return ret;		}				public function getDirName() : String {			return m_textDirName.text;		}		public function clearDirName() {			m_textDirName.text = "";		}		function getBitmapFilter():BitmapFilter {            var color:Number = 0x000000;            var angle:Number = 45;            var alpha:Number = 0.5;            var blurX:Number = 5;            var blurY:Number = 5;            var distance:Number = 5;            var strength:Number = 0.65;            var inner:Boolean = false;            var knockout:Boolean = false;            var quality:Number = BitmapFilterQuality.HIGH;            return new DropShadowFilter(distance,                                        angle,                                        color,                                        alpha,                                        blurX,                                        blurY,                                        strength,                                        quality,                                        inner,                                        knockout);        }	}}